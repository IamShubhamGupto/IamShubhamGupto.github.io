<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Google Sheets macro-scripts | Shubham Gupta</title> <meta name="author" content=" Shubham Gupta"> <meta name="description" content="Automatic notifications for Google sheet changes"> <meta name="keywords" content="jekyll, jekyll-theme, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://iamshubhamgupto.github.io/blog/2023/google-sheet-macro-scripts/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/vim.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Shubham Gupta</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/news/">News</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/opensource/">Open Source</a> </li> <li class="nav-item "> <a class="nav-link" href="/assets/pdf/Shubham_Gupta_Resume.pdf" target="_blank">Resume</a> </li> <li class="nav-item "> <a class="nav-link" href="/research/">Research</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">Teaching</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Google Sheets macro-scripts</h1> <p class="post-meta">March 5, 2023</p> <p class="post-tags"> <a href="/blog/2023"> <i class="fas fa-calendar fa-sm"></i> 2023 </a> Â  Â· Â  <a href="/blog/tag/code"> <i class="fas fa-hashtag fa-sm"></i> code</a> Â  <a href="/blog/tag/apps-script"> <i class="fas fa-hashtag fa-sm"></i> apps-script</a> Â  <a href="/blog/tag/google-sheets"> <i class="fas fa-hashtag fa-sm"></i> google-sheets</a> Â  <a href="/blog/tag/automation"> <i class="fas fa-hashtag fa-sm"></i> automation</a> Â  Â  Â· Â  <a href="/blog/category/code"> <i class="fas fa-tag fa-sm"></i> code</a> Â  <a href="/blog/category/automation"> <i class="fas fa-tag fa-sm"></i> automation</a> Â  </p> </header> <article class="post-content"> <p>Todayâ€™s post is about how my flatmates and I use google sheets to track regular house chores and how my coding skills simplifies this process slightly more. At this point, it may seem like I like to blog exclusively about automation of simple tasks but I actually do have more interests!!ðŸ¤¡</p> <h2 id="the-problem">The Problem</h2> <p>Nobody likes to get their hands dirty and take out the trash, fill the dishwasher with the dirty dishes or even has the time to periodically clean the whole house. Atleast this describes us in a single sentence. Before tracking chores on the sheet, we would do these tasks randomly and nobody could actually account for their actions. It would be seem like we were responsible for ourselves and others when the responsibility should be fairly distributed.</p> <h2 id="the-solution">The Solution</h2> <p>We agreed to use Google Sheets to track all the household tasks. We would do these tasks in a cyclic order and then fill in details such as <code class="language-plaintext highlighter-rouge">date</code> and <code class="language-plaintext highlighter-rouge">cleaned by</code> on sheet. This solved the ambiguity of who is supposed to clear the trash or empty the dishwasher and we had a smooth system for the remaining semester. However, this system did not carry over to our current semester.</p> <h2 id="the-problem--part-2">The Problem : part 2</h2> <p>The three of us this semester have more demanding and polar schedules resulting in us catching up just once every week compared to almost everyday during the previous semester. A bigger side effect of such schedules is we miss checking the sheet for our turn or complete the task and then forget to update the sheet. This results in the trash overflowing again and the sink packed with dirty dishes.</p> <h2 id="the-real-solution">The REAL solution</h2> <p>This is where I come in. A couple of weeks back one of my flatmates came up with the idea of setting reminders based on who last edited the google sheet. Having very little time to investigate, the idea was soon dropped and made no progress.</p> <p>Recently, I have been doing my tasks in a timely manner but I keep forgetting to update the sheet, resulting in the next flatmate to think its still my turn. To address this problem, I brought back the reminder idea based on the google sheet using <a href="https://developers.google.com/apps-script" rel="external nofollow noopener" target="_blank">Apps Script</a>.</p> <h3 id="pseudo-code">Pseudo code</h3> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nf">clearDishwasher</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nx">current_sheet</span> <span class="o">=</span> <span class="nf">getCurrentSheet</span><span class="p">();</span>
    <span class="nx">current_range</span> <span class="o">=</span> <span class="nx">current_sheet</span><span class="p">.</span><span class="nf">getCurrentRange</span><span class="p">();</span>
    <span class="nx">current_column</span> <span class="o">=</span> <span class="nx">current_range</span><span class="p">.</span><span class="nf">getColumn</span><span class="p">();</span>
    <span class="c1">// emptied by is in column 3</span>
    <span class="k">if </span><span class="p">(</span> <span class="nx">current_column</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="nx">name</span> <span class="o">=</span> <span class="nx">current_sheet</span><span class="p">.</span><span class="nf">getRange</span><span class="p">(</span><span class="nx">sheet</span><span class="p">.</span><span class="nf">getLastRow</span><span class="p">(),</span> <span class="nx">current_column</span><span class="p">).</span><span class="nf">getValue</span><span class="p">();</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">name</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">name1</span><span class="dl">'</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="nx">MailApp</span><span class="p">.</span><span class="nf">sendEmail</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="na">to</span><span class="p">:</span> <span class="dl">"</span><span class="s2">email1@haha.com</span><span class="dl">"</span><span class="p">,</span>
                    <span class="na">subject</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Time to Clear Dishwasher!!!</span><span class="dl">"</span><span class="p">,</span>
                    <span class="na">body</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Hi name1, this is an automated mail to inform you that name3 has cleared the dishwasher, its your turn next!!</span><span class="dl">"</span>
                <span class="p">}</span>
            <span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if </span><span class="p">(</span><span class="nx">name</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">name2</span><span class="dl">'</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="nx">MailApp</span><span class="p">.</span><span class="nf">sendEmail</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="na">to</span><span class="p">:</span> <span class="dl">"</span><span class="s2">email2@haha.com</span><span class="dl">"</span><span class="p">,</span>
                    <span class="na">subject</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Time to Clear Dishwasher!!!</span><span class="dl">"</span><span class="p">,</span>
                    <span class="na">body</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Hi name2, this is an automated mail to inform you that name1 has cleared the dishwasher, its your turn next!!</span><span class="dl">"</span>
                <span class="p">}</span>
            <span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> 
        <span class="p">{</span>
            <span class="nx">MailApp</span><span class="p">.</span><span class="nf">sendEmail</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="na">to</span><span class="p">:</span> <span class="dl">"</span><span class="s2">email3@haha.com</span><span class="dl">"</span><span class="p">,</span>
                    <span class="na">subject</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Time to Clear Dishwasher!!!</span><span class="dl">"</span><span class="p">,</span>
                    <span class="na">body</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Hi name3, this is an automated mail to inform you that name2 has cleared the dishwasher, its your turn next!!</span><span class="dl">"</span>
                <span class="p">}</span>
            <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="triggers">Triggers</h3> <p>Coding it was not so bad. Especially now that we have ChatGPT ðŸŒš. However, we need to tell sheets when to run our script otherwise its back to manually running the notifications again. For this, under the <strong>Triggers</strong> tab on the left of the Apps Script page, we specify when the function is to be executed. Here are my settings:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Function to run: clearDishwasher,
Which runs at deployment: Head,
Select event source: From spreadsheet,
Select event type: On change,
</code></pre></div></div> <p>The above settings basically tells google sheet to call <code class="language-plaintext highlighter-rouge">clearDishwasher</code> whenever there is a change in the spreadsheet.</p> <h2 id="conclusion">Conclusion</h2> <p>We now have a system that tracks who has completed which household task and also give us reminders when its our turn to do the task. Since the reminder system was just added, we still need to use it and see how viable it is. The entire script can be found here <a href="https://github.com/IamShubhamGupto/Apps-script" rel="external nofollow noopener" target="_blank"> Apps Script </a>.</p> </article> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container"> Â© Copyright 2024 Shubham Gupta. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>