<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Automation with web scrapping | Shubham Gupta</title> <meta name="author" content=" Shubham Gupta"> <meta name="description" content="Simplying data collection from web sites using Python web scrapping"> <meta name="keywords" content="jekyll, jekyll-theme, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://iamshubhamgupto.github.io/blog/2023/automation-with-web-scrapping/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/vim.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Shubham Gupta</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/news/">News</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/opensource/">Open Source</a> </li> <li class="nav-item "> <a class="nav-link" href="/assets/pdf/Shubham_Gupta_Resume.pdf" target="_blank">Resume</a> </li> <li class="nav-item "> <a class="nav-link" href="/research/">Research</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">Teaching</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Automation with web scrapping</h1> <p class="post-meta">February 12, 2023</p> <p class="post-tags"> <a href="/blog/2023"> <i class="fas fa-calendar fa-sm"></i> 2023 </a>   ·   <a href="/blog/tag/code"> <i class="fas fa-hashtag fa-sm"></i> code</a>   <a href="/blog/tag/github"> <i class="fas fa-hashtag fa-sm"></i> github</a>   <a href="/blog/tag/python"> <i class="fas fa-hashtag fa-sm"></i> python</a>   <a href="/blog/tag/web-scrapping"> <i class="fas fa-hashtag fa-sm"></i> web-scrapping</a>     ·   <a href="/blog/category/code"> <i class="fas fa-tag fa-sm"></i> code</a>   <a href="/blog/category/automation"> <i class="fas fa-tag fa-sm"></i> automation</a>   </p> </header> <article class="post-content"> <p>My work with NYU Marron requires me to automate fence, wall and building annotation on Google Street View images. While this project can be an entire blog separately, I wanted to write specifically about the recent progress I had made. There is a publically available dataset <a href="https://www.cityscapes-dataset.com" rel="external nofollow noopener" target="_blank">Cityscapes</a> that consists of per-pixel annotations of street videos of 50 cities in and around Germany. While this is not ideal as we are dealing with street view images of New York, it should be a good starting point. Once we establish a baseline on pretrained models from other cities, we could then decide if we need to custom train a model of our own based on the performance.</p> <p>Since Cityscapes is used a benchmark for lot of the segmentation tasks in Computer Vision, the website also hosts information on methodologies and their performance per class label. This is very interesting as currently, we just need to a model / method that can segment fences, walls and buildings with a good degree of confidence.</p> <p>However, scrolling through the entire list just to find the best model for these classes can be very time consuming and requires a lot of effort. What if we could get someone to do this task? Using python modules such as <code class="language-plaintext highlighter-rouge">bs4.BeautifulSoup</code> and <code class="language-plaintext highlighter-rouge">requests</code>, we can complete hours of tedious work in a couple of minutes.</p> <h2 id="workflow">Workflow</h2> <h3 id="read-the-base-site">Read the base site</h3> <p>We first want to download the page of interest and loaded into memory. We achieve this using <code class="language-plaintext highlighter-rouge">requests</code> and parse the content using <code class="language-plaintext highlighter-rouge">bs4.BeautifulSoup</code>.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">from</span> <span class="n">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://www.cityscapes-dataset.com/benchmarks/#scene-labeling-task</span><span class="sh">"</span>

<span class="c1"># Make a GET request to fetch the web page
</span><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="c1"># Parse the HTML content of the page
</span><span class="n">soup</span> <span class="o">=</span> <span class="nc">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">content</span><span class="p">,</span> <span class="sh">"</span><span class="s">html.parser</span><span class="sh">"</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">soup</span><span class="p">)</span>
</code></pre></div></div> <h3 id="parse-the-site">Parse the site</h3> <p><code class="language-plaintext highlighter-rouge">BeautifulSoup</code> class comes loaded with multiple functions that we will be using to extract useful information very straightforward. We know we are interested in the methods presented in the tabulated format. Hence, we ask BeautifulSoup to fetch all elements and their children that contain the tag <code class="language-plaintext highlighter-rouge">&lt;tr&gt;</code>.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Find the table with the required data
</span><span class="n">table</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="sh">"</span><span class="s">table</span><span class="sh">"</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="sh">"</span><span class="s">tablepress tablepress-id-2 tablepress-row-details tablepress-responsive</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># Extract the data from the table and store it in a list of dictionaries
</span><span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">rows</span> <span class="o">=</span> <span class="n">table</span><span class="p">.</span><span class="nf">find_all</span><span class="p">(</span><span class="sh">"</span><span class="s">tr</span><span class="sh">"</span><span class="p">)</span>

</code></pre></div></div> <h3 id="search-for-the-keywords-you-want">Search for the keywords you want</h3> <p>We notice that each row only contains generic information that talks about the overall performance and modes used. The real data is hidden away in a hyperlink that goes to the method submission page. Our workflow now would be to:</p> <ul> <li>Find the model submission link for each method</li> <li>Load the contents of the submission page locally</li> <li>Filter content of the page based on a few keywords like ‘name’, ‘building’, ‘fence’ etc</li> </ul> <p>This step may take a while depending on the page youre loading. If youre following the blog for the exact same site, the answer is below. Otherwise, I’d recommend to code this section iteratively by looking at the output generated at each step.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">interests</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">building</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">fence</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">wall</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">vegetation</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">link</span><span class="sh">'</span><span class="p">]</span>
<span class="n">data</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">interests</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="n">row</span><span class="p">.</span><span class="nf">find_all</span><span class="p">(</span><span class="sh">"</span><span class="s">a</span><span class="sh">"</span><span class="p">,</span> <span class="n">href</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    
    <span class="n">detail_links</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="sh">"</span><span class="s">https://www.cityscapes-dataset.com/method-details/?submissionID=</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">x</span><span class="p">[</span><span class="sh">'</span><span class="s">href</span><span class="sh">'</span><span class="p">]]</span>
    
    <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">detail_links</span><span class="p">:</span>
        <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">detail_response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">link</span><span class="p">[</span><span class="sh">'</span><span class="s">href</span><span class="sh">'</span><span class="p">])</span>
        <span class="n">detail_soup</span> <span class="o">=</span> <span class="nc">BeautifulSoup</span><span class="p">(</span><span class="n">detail_response</span><span class="p">.</span><span class="n">content</span><span class="p">,</span> <span class="sh">"</span><span class="s">html.parser</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">table_datas</span> <span class="o">=</span> <span class="p">[</span> <span class="n">i</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="nf">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">detail_soup</span><span class="p">.</span><span class="nf">find_all</span><span class="p">(</span><span class="sh">"</span><span class="s">td</span><span class="sh">"</span><span class="p">)]</span>

        <span class="k">for</span> <span class="n">interest</span> <span class="ow">in</span> <span class="n">interests</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">interest</span> <span class="ow">in</span> <span class="n">table_datas</span><span class="p">:</span>
                 <span class="n">row</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">table_datas</span><span class="p">[</span><span class="n">table_datas</span><span class="p">.</span><span class="nf">index</span><span class="p">(</span><span class="n">interest</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">row</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">link</span><span class="p">[</span><span class="sh">'</span><span class="s">href</span><span class="sh">'</span><span class="p">])</span>
        <span class="n">data</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                
<span class="nf">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></div> <h3 id="format-and-store-data">Format and store data</h3> <p>Now that you have the data you were scouting for, its time to store it in a human presentable format. I use the <code class="language-plaintext highlighter-rouge">pandas</code> library to first convert it into a dataframe and then into an excel spreadsheet. Now further analysis can be carried out using the tools of your choice.</p> <h2 id="conclusion">Conclusion</h2> <p>You just coded a simple web-scrapper using python to collect the data of your interest. I hope the guide was helpful, do reachout to me via mail if you have any ideas for improving my blogging style. This is something I started recently and am working on to improve. The code for this blog should be up on my GitHub hopefully before the next weekend.</p> </article> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container"> © Copyright 2024 Shubham Gupta. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>